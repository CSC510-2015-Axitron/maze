<html>
	<head>
		<script type="text/javascript" src="./jquery-2.1.3.min.js"></script>
		<script type="text/javascript" src="./firebase.js"></script>
		<style>
			.box {
					padding: 2px;
					border: solid 1px black;
			}
		</style>
	</head>
	<body>
		<script type="text/javascript">
			$(function () {
				var onSuccess = function(authPayload) {
					console.log("Success!");
					console.log(authPayload);
					firebase.once('value', function(snap) {
						$('#log').html(recurseAppend(snap.val(), Array(), 1).join(""));
						firebase.unauth();
					});
				},
				onFailure = function(err) {
					console.log("Error!");
					console.log(err)
				},
				recurseAppend = function(thing, txt, level) {
					txt.push(Array(level+1).join("  "));
					if(thing !== null && typeof thing === 'object')
					{
						txt.push("<div class='box'>");
						for (var key in thing) {
						  if (thing.hasOwnProperty(key)) {
						  	txt.push((Array(level+2).join(" "))+key+":");
						    txt = recurseAppend(thing[key], txt, level+1);
								txt.push("<br />");
						  }
						}
						txt.push(Array(level+1).join(" ")+"</div>");
					}
					else
					{
						txt.push(Array(level+1).join(" ")+thing);
					}
					return txt;
				}
				firebase = new Firebase("https://axemaze.firebaseio.com/");
				firebase.authWithCustomToken("EiLQ9QqgIIyvc5sxopJ73TfuVlv4sFcGpG2w6tpa", function(err, payload) {
					if(err === null)
						onSuccess(payload);
					else
						onFailure(err);
					});
			});
		</script>
		<div id="log"></div>
	</body>
</html>